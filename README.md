# Kavlar
## Introduction
Torah scrolls have many traditional formatting constraints, including fixed-width columns, forced line breaks at particular narritive points in the text and special formatting for biblical poetry, etc. Historically, expert Jewish scribes (*sof'rim*) would manually lay out of a guide for the production of a Torah scroll called a *tikkun*. *Tikkun*s encode both normative agreed-upon formatting customs as well as various local traditions and some have been passed down for many generations. 

One especially challenging aspect of manually laying-out a *sefer Torah* is producing fixed-width columns by hand without excessive or insufficient whitespace between words and letters. According to tradition, some letters can be stretched in order to aid in justifying the text. These manipulations have a tendency to compromise the aesthetics and legibility of a text that is read ritually at least thrice weekly in traditional Jewish communities. 

The de-facto standard for most new Torah scrolls was developed in the last 30 years by Rabbi Menachem Davidovich of Jerusalem. Davidovich's *tikkun* has 247 42-line columns, follows all *Ashkenazi* scribal traditions and uses no stretched letters. The manual production of such a layout is an incredible feat of human ingenuity, requiring an enormous degree of planning and back-tracking to achieve a fixed-width layout. Indeed, Davidovich dryly told my father Jack was "very hard work" (my translation from Hebrew). 

Over roughly the same time period, generic computer algorithms for automating the justification of text have progressed rapidly. The seminal publicaion in this field is due to Donald Knuth and Michael Plass, entitled "Breaking paragraphs into lines" (Software: Practice and Experience, 1981). We think of this project as mediating a virtual dialog between Knuth and Davidovich, two masters in their respective fields. 

## Overview of Kavlar
Kavlar is designed similarly to a two-pass compiler. The input to Kavlar is the HTML-formatted text of the Torah produced by the webmasters of [Mechon Mamre](http://mechon-mamre.org), which is parsed and converted into an intermediate XML format. The XML  can then be compiled into LateX code, where a series of macros are used to ensure that traditional formatting rules are observed. 

One difference between Kavlar and a compiler is that the intermediate XML format is designed to be manually edited. Our reasoning here is that many of the formatting constraints and traditions associated with a Torah scrolls are not included in the HTML files produced by [Mechon Mamre](http://mechon-mamre.org). As such, we produce an initial XML file by automated compilation from HTML and we subsequently manually edit that file to include information relevant to formatting and layout traditions. 
